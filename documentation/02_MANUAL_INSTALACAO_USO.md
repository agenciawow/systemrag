# üìö Manual Completo - Sistema RAG Multimodal

## üéØ Para Quem √© Este Manual

Este manual foi criado para **iniciantes completos** que querem configurar e usar um sistema RAG (Retrieval-Augmented Generation) profissional. N√£o √© necess√°rio ter experi√™ncia pr√©via com programa√ß√£o ou intelig√™ncia artificial.

**O que voc√™ vai aprender:**
- ‚úÖ Como configurar o sistema do zero
- ‚úÖ Como indexar seus documentos 
- ‚úÖ Como fazer buscas inteligentes
- ‚úÖ Como avaliar a qualidade do sistema
- ‚úÖ Como personalizar para seu neg√≥cio

---

## üìã √çndice

1. [Pr√©-requisitos](#1-pr√©-requisitos)
2. [Instala√ß√£o](#2-instala√ß√£o)
3. [Configura√ß√£o das APIs](#3-configura√ß√£o-das-apis)
4. [Configura√ß√£o do Sistema](#4-configura√ß√£o-do-sistema)
5. [Entendendo o Sistema Dual](#5-entendendo-o-sistema-dual)
6. [Primeiro Uso](#6-primeiro-uso)
7. [Indexando Seus Documentos](#7-indexando-seus-documentos)
8. [Fazendo Buscas](#8-fazendo-buscas)
9. [Sistema de Agents (Avan√ßado)](#9-sistema-de-agents-avan√ßado)
10. [Sistema de Avalia√ß√£o](#10-sistema-de-avalia√ß√£o)
11. [Personaliza√ß√£o Avan√ßada](#11-personaliza√ß√£o-avan√ßada)
12. [Resolu√ß√£o de Problemas](#12-resolu√ß√£o-de-problemas)
13. [Dicas e Melhores Pr√°ticas](#13-dicas-e-melhores-pr√°ticas)
14. [APIs RESTful para Integra√ß√£o](#14-apis-restful-para-integra√ß√£o)
15. [Testes Automatizados](#15-testes-automatizados)

---

## 1. Pr√©-requisitos

### 1.1. Conhecimentos Necess√°rios
- ‚úÖ Saber usar o computador b√°sico
- ‚úÖ Saber abrir arquivos e pastas
- ‚úÖ N√£o precisa saber programar!

### 1.2. O Que Voc√™ Precisa Ter

#### Hardware M√≠nimo
- **Computador**: Windows, Mac ou Linux
- **RAM**: Pelo menos 4GB (recomendado 8GB+)
- **Espa√ßo**: 2GB livres no disco
- **Internet**: Conex√£o est√°vel

#### Contas Necess√°rias (gratuitas)
1. **OpenAI** - Para intelig√™ncia artificial
2. **Voyage AI** - Para an√°lise de texto
3. **Astra DB** - Para banco de dados
4. **Cloudflare** - Para armazenar imagens
5. **Google Drive** - Para documentos (opcional)

> üí° **Importante**: Todas essas contas t√™m vers√µes gratuitas suficientes para come√ßar!

---

## 2. Instala√ß√£o

### 2.1. Instalando o Python

#### No Windows:
1. V√° para https://python.org
2. Clique em "Download Python" (vers√£o 3.11 ou superior)
3. Execute o arquivo baixado
4. ‚ö†Ô∏è **IMPORTANTE**: Marque "Add Python to PATH"
5. Clique em "Install Now"

#### No Mac:
1. Abra o Terminal (Cmd + Espa√ßo, digite "Terminal")
2. Digite: `python3 --version`
3. Se n√£o tiver Python, instale pelo site python.org

#### No Linux (Ubuntu/Debian):
```bash
sudo apt update
sudo apt install python3 python3-pip
```

### 2.2. Verificando a Instala√ß√£o
Abra o terminal/prompt de comando e digite:
```bash
python --version
```
Deve mostrar algo como "Python 3.11.x" ou superior.

### 2.3. Baixando o Sistema RAG

#### Op√ß√£o 1: Download Direto (Mais F√°cil)
1. Baixe o arquivo ZIP do sistema
2. Extraia em uma pasta (ex: `C:\MeuSistemaRAG`)
3. Abra o terminal nesta pasta

#### Op√ß√£o 2: Git (Para Quem Conhece)
```bash
git clone [URL_DO_REPOSITORIO]
cd sistemarag
```

### 2.4. Instalando as Depend√™ncias
No terminal, dentro da pasta do sistema, digite:
```bash
pip install -r requirements.txt
```

‚è≥ **Aguarde**: Pode levar alguns minutos para instalar tudo.

---

## 3. Configura√ß√£o das APIs

### üß† **Nova Funcionalidade: Mem√≥ria Persistente com Zep**

A partir desta vers√£o, o sistema inclui **mem√≥ria persistente** usando a plataforma Zep. Isso permite que os agents lembrem de conversas anteriores, extraiam insights automaticamente e mantenham contexto entre sess√µes.

#### **Benef√≠cios da Mem√≥ria Zep:**
- üß† **Conversas cont√≠nuas**: Agents lembram de intera√ß√µes anteriores
- üìä **Extra√ß√£o autom√°tica**: Fatos e entidades s√£o identificados automaticamente  
- üîç **Busca contextual**: Busca sem√¢ntica no hist√≥rico de conversas
- üë• **Multi-usu√°rio**: Cada usu√°rio tem seu contexto isolado

## 3. Configura√ß√£o das APIs

### 3.1. OpenAI (Obrigat√≥rio)

#### Criando Conta:
1. V√° para https://platform.openai.com
2. Clique em "Sign up" 
3. Crie sua conta (email + senha)
4. Confirme o email

#### Obtendo a Chave:
1. Fa√ßa login em https://platform.openai.com
2. Clique no seu perfil (canto superior direito)
3. V√° em "API keys"
4. Clique "Create new secret key"
5. **‚ö†Ô∏è COPIE E GUARDE**: A chave come√ßa com `sk-`

#### Adicionando Cr√©ditos:
1. V√° em "Billing" no menu
2. Adicione pelo menos $5 (suficiente para muitos testes)
3. Configure limite de gastos para seguran√ßa

### 3.2. Voyage AI (Obrigat√≥rio)

#### Criando Conta:
1. V√° para https://www.voyageai.com
2. Clique em "Get Started"
3. Crie conta com GitHub ou Google
4. Confirme o email

#### Obtendo a Chave:
1. V√° para o Dashboard
2. Clique em "API Keys"
3. Crie uma nova chave
4. **‚ö†Ô∏è COPIE E GUARDE**: A chave come√ßa com `pa-`

### 3.3. Astra DB (Obrigat√≥rio)

#### Criando Conta:
1. V√° para https://astra.datastax.com
2. Clique "Start Free"
3. Registre-se (gratuito at√© 25GB)

#### Criando Banco:
1. No dashboard, clique "Create Database"
2. Escolha "Serverless"
3. Nome: `sistemarag`
4. Keyspace: `default_keyspace`
5. Regi√£o: Escolha a mais pr√≥xima
6. Clique "Create Database"

#### Obtendo Credenciais:
1. Na lista de bancos, clique no seu banco
2. V√° em "Connect" ‚Üí "APIs"
3. Copie o **Database ID** e **Region**
4. V√° em "Settings" ‚Üí "Application Tokens"
5. Clique "Generate Token"
6. Papel: "Database Administrator"
7. **‚ö†Ô∏è COPIE E GUARDE**: Token + Endpoint

### 3.4. Cloudflare R2 (Obrigat√≥rio)

#### Criando Conta:
1. V√° para https://cloudflare.com
2. Clique "Sign up"
3. Crie conta gratuita

#### Configurando R2:
1. No dashboard, v√° em "R2 Object Storage"
2. Clique "Create bucket"
3. Nome: `sistemarag-images`
4. Regi√£o: Automatic

#### Criando Worker:
1. V√° em "Workers & Pages"
2. Clique "Create Application" ‚Üí "Create Worker"
3. Nome: `sistemarag-api`
4. Substitua o c√≥digo pelo c√≥digo fornecido no README
5. Clique "Save and Deploy"

#### Configurando Vari√°veis:
1. No Worker, v√° em "Settings" ‚Üí "Variables"
2. Adicione:
   - `AUTH_TOKEN`: Crie uma senha secreta (ex: `minha-senha-123`)
   - `BUCKET`: `sistemarag-images`

### 3.5. Zep Memory (Obrigat√≥rio para Agents)

**üß† O que √© Zep?** Plataforma de mem√≥ria que permite que os agents lembrem de conversas anteriores e mantenham contexto entre sess√µes.

#### Criando Conta:
1. V√° para https://cloud.getzep.com
2. Clique em "Sign Up"
3. Crie conta com email ou GitHub
4. Confirme o email

#### Obtendo a Chave:
1. Fa√ßa login no dashboard
2. V√° em "API Keys" ou "Settings"
3. Clique "Create API Key"
4. **‚ö†Ô∏è COPIE E GUARDE**: A chave do Zep

#### Por que √© Importante:
- üß† **Agents lembram**: De conversas anteriores
- üìä **Extra√ß√£o autom√°tica**: De fatos e informa√ß√µes importantes
- üë• **Multi-usu√°rio**: Cada pessoa tem seu contexto isolado
- üîç **Busca inteligente**: No hist√≥rico de conversas

**üí° Dica**: O Zep √© usado apenas pelos Agents (porta 8001). O Sistema RAG tradicional (porta 8000) funciona sem ele.

### 3.6. Google Drive (Opcional)

Se voc√™ quiser indexar documentos do Google Drive:

1. Coloque seu documento no Google Drive
2. Clique com bot√£o direito ‚Üí "Compartilhar"
3. Altere para "Qualquer pessoa com o link"
4. Copie o link completo

---

## 4. Configura√ß√£o do Sistema

### 4.1. Arquivo de Configura√ß√£o (.env)

1. Na pasta do sistema, encontre o arquivo `.env.example`
2. Copie e renomeie para `.env`
3. Abra o arquivo `.env` em um editor de texto
4. Preencha com suas chaves:

```bash
# APIs Externas
OPENAI_API_KEY=sk-sua-chave-openai-aqui
VOYAGE_API_KEY=pa-sua-chave-voyage-aqui
LLAMA_CLOUD_API_KEY=llx-sua-chave-llama-aqui
ZEP_API_KEY=zep-sua-chave-zep-aqui

# Astra DB
ASTRA_DB_APPLICATION_TOKEN=AstraCS:seu-token-aqui
ASTRA_DB_API_ENDPOINT=https://database-id-region.apps.astra.datastax.com
ASTRA_DB_KEYSPACE=default_keyspace
ASTRA_DB_COLLECTION=meu_negocio

# Cloudflare R2
R2_ENDPOINT=https://seu-worker.workers.dev
R2_AUTH_TOKEN=sua-senha-secreta

# Google Drive Document (se estiver usando)
GOOGLE_DRIVE_URL=https://drive.google.com/file/d/SEU_ID/view

# Modelos OpenAI (opcional - deixe como est√°)
OPENAI_RERANK_MODEL=gpt-4o-mini
OPENAI_QUERY_TRANSFORM_MODEL=gpt-4o-mini
OPENAI_ANSWER_GENERATION_MODEL=gpt-4o
OPENAI_EXTRACTION_MODEL=gpt-4o
```

### 4.2. Configura√ß√£o das Perguntas de Avalia√ß√£o

No mesmo arquivo `.env`, configure as perguntas que o sistema usar√° para se auto-avaliar:

```bash
# Perguntas para seu tipo de neg√≥cio (exemplo: restaurante)
EVAL_QUESTIONS=Quais pratos voc√™s servem?|Qual √© o pre√ßo do prato mais caro?|Voc√™s fazem delivery?|Qual o hor√°rio de funcionamento?|Voc√™s t√™m op√ß√µes vegetarianas?

# Palavras-chave que devem aparecer nas respostas
EVAL_KEYWORDS=pratos,card√°pio,menu,comida|pre√ßo,valor,caro,custo|delivery,entrega,domic√≠lio|hor√°rio,funcionamento,aberto|vegetariano,vegano,sem carne

# Categorias das perguntas
EVAL_CATEGORIES=menu|pricing|delivery|hours|dietary
```

**Como personalizar para seu neg√≥cio:**

- **Loja de roupas**: "Quais tamanhos voc√™s t√™m?|Fazem trocas?|T√™m desconto?"
- **Consultoria**: "Quais servi√ßos oferecem?|Como funciona o or√ßamento?|Qual o prazo?"
- **Escola**: "Quais cursos t√™m?|Como √© a mensalidade?|T√™m aulas online?"

### 4.3. Testando a Configura√ß√£o

No terminal, digite:
```bash
python -c "from system_rag.config.settings import settings; print('‚úÖ Configura√ß√£o OK!')"
```

Se aparecer "‚úÖ Configura√ß√£o OK!", est√° tudo certo!

---

## 5. Entendendo o Sistema Dual

### 5.1. Duas APIs Diferentes - Qual Usar?

O sistema oferece **duas maneiras** de buscar informa√ß√µes. Como iniciante, √© importante entender a diferen√ßa:

#### üîß **Sistema RAG Tradicional (Porta 8000)**
- **O que √©**: Sistema de busca cl√°ssico e confi√°vel
- **Quando usar**: Para a maioria dos casos, especialmente no in√≠cio
- **Como iniciar**: `python run_system_api.py`
- **Caracter√≠sticas**:
  - ‚úÖ Mais simples de usar
  - ‚úÖ Respostas diretas e precisas
  - ‚úÖ Ideal para sites, chatbots b√°sicos
  - ‚úÖ Melhor para come√ßar

#### ü§ñ **Sistema de Agents (Porta 8001)**  
- **O que √©**: Sistema inteligente que "pensa" antes de responder
- **Quando usar**: Para casos mais complexos e conversa√ß√µes
- **Como iniciar**: `python run_agents_api.py`
- **Caracter√≠sticas**:
  - üß† Mais inteligente e conversacional
  - üîÑ Consegue manter contexto de conversa
  - üíæ **Mem√≥ria persistente com Zep** (lembra de conversas anteriores)
  - üìä Extrai fatos e insights automaticamente
  - üéØ Melhor para assistentes virtuais
  - ‚ö° Mais lento que o sistema tradicional

### 5.2. Recomenda√ß√£o para Iniciantes

**üìö Come√ße sempre com o Sistema RAG Tradicional (porta 8000)**

1. √â mais f√°cil de entender
2. Responde mais r√°pido
3. Consome menos recursos
4. Menos complexo para configurar

**üöÄ Depois que dominar, experimente os Agents (porta 8001)**

### 5.3. Posso Usar os Dois?

**Sim!** Voc√™ pode rodar ambos ao mesmo tempo:

```bash
# Terminal 1: Sistema RAG
python run_system_api.py

# Terminal 2: Sistema Agents (novo terminal)
python run_agents_api.py
```

Eles funcionam em portas diferentes e n√£o conflitam.

### 5.4. Como Escolher na Pr√°tica

| Cen√°rio | Recomenda√ß√£o |
|---------|-------------|
| Site com FAQ | üîß Sistema RAG (8000) |
| Chatbot simples | üîß Sistema RAG (8000) |
| Assistente conversacional | ü§ñ Agents (8001) |
| Suporte t√©cnico avan√ßado | ü§ñ Agents (8001) |
| Primeira vez usando | üîß Sistema RAG (8000) |

---

## 6. Primeiro Uso

### 6.1. Teste R√°pido do Sistema RAG

Vamos fazer um teste simples para ver se tudo est√° funcionando:

```bash
python -c "
from system_rag.search.conversational_rag import ModularConversationalRAG
rag = ModularConversationalRAG()
print('‚úÖ Sistema RAG inicializado com sucesso!')
"
```

### 6.2. Iniciando o Sistema RAG (Recomendado para Iniciantes)

```bash
python run_system_api.py
```

Se funcionou, voc√™ ver√°:
```
üöÄ Iniciando API do Sistema RAG...
üìç Porta: 8000
üìö Docs: http://localhost:8000/docs
```

### 6.3. Se Deu Erro

**Erro comum**: "Module not found"
```bash
# Instale novamente as depend√™ncias
pip install --upgrade -r requirements.txt
```

**Erro de chave API**: Verifique se todas as chaves no `.env` est√£o corretas.

**Erro de conex√£o**: Verifique sua internet e se as URLs est√£o corretas.

---

## 7. Indexando Seus Documentos

### 7.1. Preparando Documentos

O sistema aceita v√°rios formatos:
- ‚úÖ PDF
- ‚úÖ Word (.docx)
- ‚úÖ PowerPoint (.pptx)
- ‚úÖ Excel (.xlsx)
- ‚úÖ Texto (.txt)
- ‚úÖ Markdown (.md)

**Dicas importantes:**
- M√°ximo 100MB por arquivo
- Textos em portugu√™s funcionam melhor
- Imagens s√£o processadas automaticamente

### 7.2. Indexa√ß√£o via Google Drive (Mais F√°cil)

#### Passo 1: Preparar Documento
1. Coloque seu documento no Google Drive
2. Configure compartilhamento p√∫blico (como explicado na se√ß√£o 3.5)
3. Copie o link

#### Passo 2: Atualizar .env
```bash
GOOGLE_DRIVE_URL=https://drive.google.com/file/d/SEU_ID_AQUI/view
```

#### Passo 3: Indexar
```bash
python system_rag/ingestion.py
```

### 7.3. Indexa√ß√£o via Arquivo Local

#### Passo 1: Copiar Arquivo
Coloque seu documento na pasta `documentos/` (crie se n√£o existir)

#### Passo 2: Indexar
```bash
python -m system_rag.ingestion.run_pipeline --file "documentos/meu_documento.pdf"
```

### 7.4. Acompanhando o Progresso

Durante a indexa√ß√£o, voc√™ ver√°:
```
üîÑ Baixando documento...
üìÑ Processando com LlamaParse...
üñºÔ∏è Extraindo imagens...
üî§ Gerando embeddings...
üíæ Salvando no banco...
‚úÖ Indexa√ß√£o conclu√≠da!
```

‚è≥ **Tempo estimado**: 2-10 minutos dependendo do tamanho do documento.

---

## 7. Fazendo Buscas

### 7.1. Interface Simples

#### Busca por Comando:
```bash
python search.py "Quais produtos voc√™s t√™m?"
```

#### Busca Interativa:
```bash
python -m system_rag.search.conversational_rag
```

Vai abrir um chat onde voc√™ pode fazer perguntas:
```
üí¨ Voc√™: Quais s√£o os pre√ßos?
ü§ñ Assistente: Baseado no documento, os pre√ßos s√£o...

üí¨ Voc√™: Fazem entrega?
ü§ñ Assistente: Sim, fazemos entrega...
```

### 7.2. Comandos Especiais no Chat

- `/help` - Mostra ajuda
- `/clear` - Limpa hist√≥rico
- `/stats` - Mostra estat√≠sticas
- `/exit` - Sair

### 7.3. Tipos de Perguntas

**‚úÖ Perguntas que funcionam bem:**
- "Quais produtos voc√™s t√™m?"
- "Qual √© o pre√ßo do X?"
- "Como funciona o processo de Y?"
- "Voc√™s fazem Z?"

**‚ùå Perguntas que n√£o funcionam:**
- Perguntas sobre informa√ß√µes n√£o no documento
- C√°lculos complexos
- Perguntas sobre eventos futuros

---

## 8. Sistema de Avalia√ß√£o

### 8.1. O Que √© a Avalia√ß√£o

O sistema inclui um avaliador autom√°tico que testa a qualidade das respostas usando perguntas que voc√™ define. √â como ter um "auditor" que verifica se o sistema est√° funcionando bem.

### 8.2. Configurando Perguntas de Teste

No arquivo `.env`, defina perguntas relevantes para seu neg√≥cio:

**Para Restaurante:**
```bash
EVAL_QUESTIONS=Quais pratos voc√™s servem?|Fazem delivery?|Qual o hor√°rio?|T√™m op√ß√µes veganas?|Como fazer reserva?

EVAL_KEYWORDS=pratos,card√°pio,comida|delivery,entrega|hor√°rio,funcionamento|vegano,vegetariano|reserva,mesa

EVAL_CATEGORIES=menu|delivery|hours|dietary|booking
```

**Para Loja Online:**
```bash
EVAL_QUESTIONS=Quais produtos vendem?|Como √© o frete?|Fazem trocas?|Quais formas de pagamento?|Tem garantia?

EVAL_KEYWORDS=produtos,itens,venda|frete,entrega,correios|troca,devolu√ß√£o|pagamento,cart√£o,pix|garantia,defeito

EVAL_CATEGORIES=catalog|shipping|returns|payment|warranty
```

### 8.3. Executando Avalia√ß√£o

```bash
python rag_evaluator.py
```

### 8.4. Entendendo os Resultados

O sistema gera dois arquivos:

#### `rag_evaluation_report.json`
Relat√≥rio t√©cnico completo com todas as m√©tricas.

#### `rag_evaluation_detailed.txt`
Relat√≥rio em portugu√™s f√°cil de entender:

```
üìä RESUMO GERAL:
‚Ä¢ Total de perguntas: 5
‚Ä¢ Avalia√ß√µes bem-sucedidas: 4
‚Ä¢ Taxa de sucesso: 80%

üìà M√âTRICAS:
‚Ä¢ Tempo m√©dio de resposta: 6.2s
‚Ä¢ Cobertura de palavras-chave: 75%

üìã RESULTADOS:
‚Ä¢ Pergunta 1: ‚úÖ Respondeu corretamente
‚Ä¢ Pergunta 2: ‚úÖ Respondeu corretamente  
‚Ä¢ Pergunta 3: ‚ùå N√£o encontrou informa√ß√£o
```

### 8.5. Interpretando M√©tricas

- **Taxa de sucesso**: % de perguntas respondidas sem erro
- **Tempo de resposta**: Velocidade do sistema
- **Cobertura de palavras-chave**: % de palavras esperadas nas respostas

**O que √© considerado bom:**
- ‚úÖ Taxa de sucesso > 70%
- ‚úÖ Tempo < 10 segundos
- ‚úÖ Cobertura > 60%

---

## 9. Personaliza√ß√£o Avan√ßada

### 9.1. Ajustando Modelos OpenAI

No `.env`, voc√™ pode escolher diferentes modelos para economizar ou ter mais qualidade:

**Configura√ß√£o Econ√¥mica:**
```bash
OPENAI_RERANK_MODEL=gpt-4o-mini
OPENAI_QUERY_TRANSFORM_MODEL=gpt-4o-mini
OPENAI_ANSWER_GENERATION_MODEL=gpt-4o-mini
OPENAI_EXTRACTION_MODEL=gpt-4o-mini
```

**Configura√ß√£o Alta Qualidade:**
```bash
OPENAI_RERANK_MODEL=gpt-4o
OPENAI_QUERY_TRANSFORM_MODEL=gpt-4o
OPENAI_ANSWER_GENERATION_MODEL=gpt-4o
OPENAI_EXTRACTION_MODEL=gpt-4o
```

### 9.2. Configurando Temperatura

A temperatura controla a "criatividade" das respostas:

```bash
# Respostas mais conservadoras/precisas
OPENAI_ANSWER_GENERATION_TEMPERATURE=0.1

# Respostas mais criativas/variadas  
OPENAI_ANSWER_GENERATION_TEMPERATURE=0.9
```

**Recomendado**: Entre 0.3 e 0.7

### 9.3. Personalizando Nome da Cole√ß√£o

Para organizar diferentes projetos:

```bash
# Para cada projeto/cliente
ASTRA_DB_COLLECTION=cliente_abc
ASTRA_DB_COLLECTION=projeto_xyz
ASTRA_DB_COLLECTION=loja_moda
```

---

## 10. Resolu√ß√£o de Problemas

### 10.1. Problemas Comuns e Solu√ß√µes

#### ‚ùå "Module not found"
**Causa**: Depend√™ncias n√£o instaladas
**Solu√ß√£o**:
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

#### ‚ùå "Authentication failed"
**Causa**: Chave de API incorreta
**Solu√ß√£o**: 
1. Verifique se a chave no `.env` est√° correta
2. Confirme se a chave n√£o expirou
3. Teste a chave na plataforma original

#### ‚ùå "Connection timeout"
**Causa**: Problema de internet ou firewall
**Solu√ß√£o**:
1. Verifique conex√£o com internet
2. Teste: `ping google.com`
3. Verifique firewall corporativo

#### ‚ùå "Quota exceeded"
**Causa**: Limite de uso da API atingido
**Solu√ß√£o**:
1. Verifique saldo nas plataformas
2. Aumente limite de gastos se necess√°rio
3. Aguarde renova√ß√£o do limite gratuito

#### ‚ùå Sistema muito lento
**Causas e solu√ß√µes**:
- **Documento muito grande**: Divida em partes menores
- **Muitas imagens**: Use documentos com menos imagens
- **Modelo muito avan√ßado**: Use `gpt-4o-mini` em vez de `gpt-4o`

#### ‚ùå Respostas ruins
**Causas e solu√ß√µes**:
- **Documento mal estruturado**: Melhore formata√ß√£o
- **Perguntas muito vagas**: Seja mais espec√≠fico
- **Temperatura muito alta**: Diminua para 0.3

### 10.2. Comandos de Diagn√≥stico

#### Teste de Conex√µes:
```bash
python -c "
from sistema_rag.search.retrieval import VectorSearcher
searcher = VectorSearcher()
result = searcher.test_connection()
print(result.message)
"
```

#### Verificar Documentos Indexados:
```bash
python -c "
from sistema_rag.search.retrieval import VectorSearcher
searcher = VectorSearcher()
print(f'Documentos: {searcher.collection.estimated_document_count()}')
"
```

#### Teste de APIs:
```bash
python -c "
from openai import OpenAI
client = OpenAI()
response = client.models.list()
print('‚úÖ OpenAI OK')
"
```

### 10.3. Logs e Depura√ß√£o

#### Ativando Logs Detalhados:
```bash
export PYTHONPATH=.
python -c "
import logging
logging.basicConfig(level=logging.DEBUG)
# Execute seu comando aqui
"
```

#### Arquivo de Log:
Os logs s√£o salvos automaticamente. Procure por arquivos `.log` na pasta do sistema.

---

## 11. Dicas e Melhores Pr√°ticas

### 11.1. Prepara√ß√£o de Documentos

#### ‚úÖ Fa√ßa:
- **Use t√≠tulos claros**: "Pre√ßos", "Servi√ßos", "Contato"
- **Organize por se√ß√µes**: Agrupe informa√ß√µes relacionadas
- **Inclua contexto**: "Nossos pre√ßos s√£o:" em vez de s√≥ "Pre√ßos:"
- **Use listas e tabelas**: Facilitam a extra√ß√£o de informa√ß√£o
- **Mantenha atualizado**: Remova informa√ß√µes obsoletas

#### ‚ùå Evite:
- Textos muito longos sem pausas
- Formata√ß√£o excessiva que confunde
- Informa√ß√µes contradit√≥rias
- Documentos com muitos tipos de letra
- Imagens com texto importante (use texto real)

### 11.2. Criando Boas Perguntas de Avalia√ß√£o

#### ‚úÖ Perguntas Efetivas:
- **Espec√≠ficas**: "Qual o pre√ßo do hamb√∫rguer?" vs "Quais s√£o os pre√ßos?"
- **Naturais**: Como um cliente real perguntaria
- **Test√°veis**: Que t√™m resposta clara no documento
- **Variadas**: Cubra diferentes aspectos do neg√≥cio

#### Exemplos por Setor:

**Restaurante:**
```
- Quais pratos t√™m no card√°pio?
- Fazem entrega em domic√≠lio?
- Qual o hor√°rio de funcionamento?
- T√™m op√ß√µes para cel√≠acos?
- Como fazer reserva?
```

**Consultoria:**
```
- Quais servi√ßos voc√™s oferecem?
- Como funciona o or√ßamento?
- Qual o tempo de projeto?
- T√™m experi√™ncia no setor X?
- Como √© o acompanhamento?
```

**E-commerce:**
```
- Quais produtos voc√™s vendem?
- Como √© calculado o frete?
- Qual o prazo de entrega?
- Fazem trocas e devolu√ß√µes?
- Quais formas de pagamento?
```

### 11.3. Otimiza√ß√£o de Performance

#### Para Economizar na API:
1. **Use modelos menores**: `gpt-4o-mini` em vez de `gpt-4o`
2. **Documente bem**: Menos re-processamento
3. **Perguntas diretas**: Evite conversas muito longas
4. **Limpe dados**: Remova informa√ß√µes desnecess√°rias

#### Para Melhor Qualidade:
1. **Use modelos maiores**: `gpt-4o` para respostas cr√≠ticas
2. **Ajuste temperatura**: 0.3-0.5 para precis√£o
3. **Mais contexto**: Documentos bem estruturados
4. **Teste regularmente**: Use o avaliador com frequ√™ncia

### 11.4. Monitoramento e Manuten√ß√£o

#### Monitore Semanalmente:
- Execute `python rag_evaluator.py`
- Verifique taxa de sucesso > 70%
- Monitore tempo de resposta < 10s
- Revise custos das APIs

#### Atualize Mensalmente:
- Revisar documentos indexados
- Atualizar perguntas de avalia√ß√£o
- Verificar novas vers√µes do sistema
- Backup das configura√ß√µes

#### Sinais de Problemas:
- ‚ùå Taxa de sucesso < 50%
- ‚ùå Tempo > 15 segundos
- ‚ùå Muitas respostas "n√£o encontrado"
- ‚ùå Custos muito altos

### 11.5. Seguran√ßa e Privacidade

#### Proteja Suas Chaves:
- ‚úÖ Nunca compartilhe o arquivo `.env`
- ‚úÖ Use senhas fortes para contas
- ‚úÖ Configure limites de gastos
- ‚úÖ Monitore uso regularmente

#### Dados Sens√≠veis:
- ‚ùå N√£o indexe documentos com dados pessoais
- ‚ùå Evite informa√ß√µes financeiras sens√≠veis
- ‚ùå N√£o inclua senhas ou tokens em documentos
- ‚úÖ Use apenas informa√ß√µes p√∫blicas ou autorizadas

---

## üéì Conclus√£o

Parab√©ns! Agora voc√™ tem um sistema RAG completo funcionando. 

**O que voc√™ consegue fazer agora:**
- ‚úÖ Indexar qualquer documento
- ‚úÖ Fazer buscas inteligentes
- ‚úÖ Avaliar qualidade automaticamente
- ‚úÖ Personalizar para seu neg√≥cio
- ‚úÖ Monitorar e manter o sistema

**Pr√≥ximos Passos:**
1. Teste com documentos reais do seu neg√≥cio
2. Configure perguntas espec√≠ficas da sua √°rea
3. Execute avalia√ß√µes regulares
4. Otimize baseado nos resultados
5. Expanda para mais documentos

**Precisa de Ajuda?**
- üìñ Releia as se√ß√µes relevantes deste manual
- üîç Use os comandos de diagn√≥stico
- üìß Verifique logs de erro
- üåê Consulte documenta√ß√£o das APIs

**Lembre-se**: Este √© um sistema profissional, mas come√ßar simples √© sempre a melhor estrat√©gia. V√° incrementando aos poucos conforme ganha experi√™ncia!

---

## 12. API RESTful para Integra√ß√£o

### 12.1. O Que √© a API

A API (Interface de Programa√ß√£o de Aplica√ß√µes) permite que outros sistemas, sites ou aplicativos usem o seu Sistema RAG automaticamente. √â como ter um "bot√£o m√°gico" que qualquer programa pode apertar para fazer perguntas e receber respostas.

**Para que serve:**
- ‚úÖ Integrar com sites e aplicativos
- ‚úÖ Criar chatbots autom√°ticos
- ‚úÖ Conectar com sistemas existentes
- ‚úÖ Fazer milhares de consultas automaticamente
- ‚úÖ Monitorar qualidade continuamente

### 12.2. Configura√ß√£o da API

#### Passo 1: Instalar Depend√™ncias
```bash
pip install fastapi uvicorn
```

#### Passo 2: Configurar Senha da API
No arquivo `.env`, adicione uma senha segura:
```bash
API_KEY=minha-senha-super-secreta-2024
```

üí° **Dica**: Use uma senha com pelo menos 20 caracteres, misturando letras, n√∫meros e s√≠mbolos.

#### Passo 3: Iniciar a API
```bash
python run_system_api.py
```

Voc√™ ver√° algo como:
```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     Application startup complete.
‚úÖ Sistema RAG inicializado com sucesso
```

#### Passo 4: Testar se Funcionou
Abra seu navegador e v√° para:
- **http://localhost:8000** - P√°gina inicial
- **http://localhost:8000/docs** - Documenta√ß√£o interativa

### 12.3. Usando a API

#### 12.3.1. Fazendo Uma Busca

**O que voc√™ precisa:**
- URL: `http://localhost:8000/search`
- M√©todo: POST
- Senha: Sua API_KEY
- Pergunta: O que voc√™ quer saber

**Exemplo com curl (linha de comando):**
```bash
curl -H "Authorization: Bearer minha-senha-super-secreta-2024" \
     -H "Content-Type: application/json" \
     http://localhost:8000/search \
     -d '{"query": "Quais produtos voc√™s t√™m?"}'
```

**Exemplo com Python:**
```python
import requests

# Configura√ß√£o
url = "http://localhost:8000/search"
senha = "minha-senha-super-secreta-2024"

headers = {
    "Authorization": f"Bearer {senha}",
    "Content-Type": "application/json"
}

# Fazer pergunta
pergunta = {"query": "Quais produtos voc√™s t√™m?"}
resposta = requests.post(url, headers=headers, json=pergunta)

# Ver resultado
resultado = resposta.json()
print("Resposta:", resultado["answer"])
print("Tempo:", resultado["response_time"], "segundos")
```

**Resultado esperado:**
```json
{
  "success": true,
  "answer": "Temos hamb√∫rgueres, batatas fritas, refrigerantes...",
  "response_time": 5.23,
  "timestamp": "2024-06-16T14:30:00Z",
  "query": "Quais produtos voc√™s t√™m?"
}
```

#### 12.3.2. Executando Avalia√ß√£o Autom√°tica

**Exemplo com Python:**
```python
import requests

url = "http://localhost:8000/evaluate"
senha = "minha-senha-super-secreta-2024"

headers = {
    "Authorization": f"Bearer {senha}",
    "Content-Type": "application/json"
}

# Executar avalia√ß√£o (n√£o precisa de dados)
resposta = requests.post(url, headers=headers)
resultado = resposta.json()

print(f"Total de perguntas: {resultado['total_questions']}")
print(f"Taxa de sucesso: {resultado['success_rate']:.1%}")
print(f"Tempo m√©dio: {resultado['average_response_time']:.2f}s")
```

#### 12.3.3. Indexando Novos Documentos (Ingest√£o)

A API tamb√©m permite indexar novos documentos remotamente, seja do Google Drive ou de URLs p√∫blicas.

**Exemplo com Python:**
```python
import requests

url = "http://localhost:8000/ingest"
senha = "minha-senha-super-secreta-2024"

headers = {
    "Authorization": f"Bearer {senha}",
    "Content-Type": "application/json"
}

# Indexar documento do Google Drive
dados = {
    "document_url": "https://drive.google.com/file/d/SEU_FILE_ID/view?usp=sharing",
    "document_name": "Novo Card√°pio 2024",
    "overwrite": True
}

resposta = requests.post(url, headers=headers, json=dados, timeout=300)
resultado = resposta.json()

if resultado["success"]:
    print(f"‚úÖ Documento indexado: {resultado['document_name']}")
    print(f"üìÑ Chunks criados: {resultado['chunks_created']}")
    print(f"‚è±Ô∏è Tempo: {resultado['processing_time']:.1f}s")
else:
    print(f"‚ùå Erro: {resultado['message']}")
```

**Exemplo com curl:**
```bash
curl -H "Authorization: Bearer sua-senha-aqui" \
     -H "Content-Type: application/json" \
     http://localhost:8000/ingest \
     -d '{
       "document_url": "https://drive.google.com/file/d/SEU_FILE_ID/view",
       "document_name": "Card√°pio Atualizado",
       "overwrite": true
     }'
```

**Tipos de URLs suportadas:**
- ‚úÖ Google Drive (compartilhamento p√∫blico)
- ‚úÖ URLs de PDFs p√∫blicos
- ‚úÖ Links diretos para documentos

**Resultado esperado:**
```json
{
  "success": true,
  "message": "Documento indexado com sucesso",
  "document_name": "Novo Card√°pio 2024",
  "chunks_created": 15,
  "processing_time": 45.3,
  "timestamp": "2024-06-16T14:30:00Z"
}
```

**‚ö†Ô∏è Importante:**
- O processamento pode demorar 30-300 segundos dependendo do tamanho
- Configure timeout alto no seu cliente (5+ minutos)
- Documentos grandes consomem mais cr√©ditos das APIs

### 12.4. Integra√ß√µes Comuns

#### 12.4.1. Site/Blog WordPress

Se voc√™ tem um site WordPress, pode criar um plugin simples:

```php
<?php
function buscar_resposta($pergunta) {
    $url = 'http://localhost:8000/search';
    $senha = 'minha-senha-super-secreta-2024';
    
    $dados = json_encode(['query' => $pergunta]);
    
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $dados);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        'Authorization: Bearer ' . $senha,
        'Content-Type: application/json'
    ]);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    
    $resposta = curl_exec($ch);
    curl_close($ch);
    
    $resultado = json_decode($resposta, true);
    return $resultado['answer'];
}

// Uso: 
echo buscar_resposta("Quais s√£o os pre√ßos?");
?>
```

#### 12.4.2. Chatbot para WhatsApp/Telegram

```python
# Exemplo b√°sico para chatbot
import requests

class ChatbotRAG:
    def __init__(self):
        self.api_url = "http://localhost:8000/search"
        self.senha = "minha-senha-super-secreta-2024"
        self.headers = {
            "Authorization": f"Bearer {self.senha}",
            "Content-Type": "application/json"
        }
    
    def responder(self, pergunta_usuario):
        try:
            resposta = requests.post(
                self.api_url,
                headers=self.headers,
                json={"query": pergunta_usuario},
                timeout=30
            )
            
            if resposta.status_code == 200:
                return resposta.json()["answer"]
            else:
                return "Desculpe, n√£o consegui processar sua pergunta."
                
        except Exception as e:
            return "Erro tempor√°rio. Tente novamente em alguns segundos."

# Usar no seu bot
bot = ChatbotRAG()
resposta = bot.responder("Quais produtos voc√™s t√™m?")
print(resposta)
```

#### 12.4.3. Site com JavaScript

```html
<!DOCTYPE html>
<html>
<head>
    <title>Meu Assistente</title>
</head>
<body>
    <h1>Fa√ßa uma Pergunta</h1>
    <input type="text" id="pergunta" placeholder="Digite sua pergunta...">
    <button onclick="buscar()">Perguntar</button>
    <div id="resposta"></div>

    <script>
    async function buscar() {
        const pergunta = document.getElementById('pergunta').value;
        const senha = 'minha-senha-super-secreta-2024';
        
        try {
            const response = await fetch('http://localhost:8000/search', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${senha}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    query: pergunta,
                    include_history: false
                })
            });
            
            const resultado = await response.json();
            document.getElementById('resposta').innerHTML = 
                `<h3>Resposta:</h3><p>${resultado.answer}</p>`;
                
        } catch (error) {
            document.getElementById('resposta').innerHTML = 
                '<p style="color: red;">Erro ao buscar resposta</p>';
        }
    }
    </script>
</body>
</html>
```

### 12.5. Monitoramento Autom√°tico

#### 12.5.1. Script de Monitoramento Di√°rio

Crie um arquivo `monitorar.py`:

```python
import requests
import schedule
import time
from datetime import datetime

def monitorar_sistema():
    """Verifica sa√∫de do sistema automaticamente"""
    url = "http://localhost:8000/evaluate"
    senha = "minha-senha-super-secreta-2024"
    
    headers = {
        "Authorization": f"Bearer {senha}",
        "Content-Type": "application/json"
    }
    
    try:
        resposta = requests.post(url, headers=headers, timeout=300)
        resultado = resposta.json()
        
        taxa_sucesso = resultado['success_rate']
        tempo_medio = resultado['average_response_time']
        
        # Log do resultado
        agora = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        print(f"[{agora}] Taxa: {taxa_sucesso:.1%}, Tempo: {tempo_medio:.1f}s")
        
        # Alertas
        if taxa_sucesso < 0.7:
            print("‚ö†Ô∏è ALERTA: Taxa de sucesso baixa!")
        
        if tempo_medio > 10:
            print("‚ö†Ô∏è ALERTA: Sistema lento!")
            
        # Salvar em arquivo
        with open("monitoramento.log", "a") as f:
            f.write(f"{agora},{taxa_sucesso},{tempo_medio}\n")
            
    except Exception as e:
        print(f"‚ùå Erro no monitoramento: {e}")

# Agendar monitoramento
schedule.every().day.at("09:00").do(monitorar_sistema)
schedule.every().day.at("18:00").do(monitorar_sistema)

# Executar
print("üîÑ Monitoramento iniciado...")
while True:
    schedule.run_pending()
    time.sleep(3600)  # Verificar a cada hora
```

Execute com:
```bash
python monitorar.py
```

#### 12.5.2. Dashboard Simples

Crie um arquivo `dashboard.py`:

```python
import requests
import time
import os

def exibir_dashboard():
    """Mostra estat√≠sticas em tempo real"""
    senha = os.getenv("API_KEY", "minha-senha-super-secreta-2024")
    
    while True:
        os.system('clear' if os.name == 'posix' else 'cls')
        
        print("=" * 50)
        print("üìä DASHBOARD - SISTEMA RAG")
        print("=" * 50)
        
        # Health check
        try:
            health = requests.get("http://localhost:8000/health", timeout=5)
            if health.status_code == 200:
                print("üü¢ Sistema: ONLINE")
            else:
                print("üî¥ Sistema: PROBLEMA")
        except:
            print("üî¥ Sistema: OFFLINE")
        
        # Avalia√ß√£o r√°pida
        try:
            headers = {"Authorization": f"Bearer {senha}"}
            eval_resp = requests.post(
                "http://localhost:8000/evaluate", 
                headers=headers, 
                timeout=60
            )
            
            if eval_resp.status_code == 200:
                data = eval_resp.json()
                print(f"üìà Taxa de Sucesso: {data['success_rate']:.1%}")
                print(f"‚è±Ô∏è Tempo M√©dio: {data['average_response_time']:.1f}s")
                print(f"üìù Total Perguntas: {data['total_questions']}")
            else:
                print("‚ùå N√£o foi poss√≠vel obter m√©tricas")
                
        except Exception as e:
            print(f"‚ùå Erro: {str(e)[:50]}...")
        
        print("=" * 50)
        print("Pressione Ctrl+C para sair")
        time.sleep(30)  # Atualizar a cada 30 segundos

if __name__ == "__main__":
    try:
        exibir_dashboard()
    except KeyboardInterrupt:
        print("\nüëã Dashboard encerrado")
```

### 12.6. Colocando em Produ√ß√£o

#### 12.6.1. Para Internet (B√°sico)

Se voc√™ quiser que outras pessoas acessem sua API pela internet:

1. **Configurar para aceitar conex√µes externas:**
```bash
uvicorn api:app --host 0.0.0.0 --port 8000
```

2. **Configurar firewall/router:**
   - Libere a porta 8000
   - Configure port forwarding se necess√°rio

3. **Usar IP p√∫blico:**
   - Sua API ficar√° em: `http://SEU_IP:8000`

#### 12.6.2. Com Dom√≠nio (Avan√ßado)

1. **Comprar um dom√≠nio** (ex: meurag.com)

2. **Configurar DNS** para apontar para seu servidor

3. **Usar Nginx como proxy:**
```bash
# Instalar Nginx
sudo apt install nginx

# Configurar em /etc/nginx/sites-available/meurag
server {
    listen 80;
    server_name meurag.com;
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

4. **Configurar SSL (HTTPS):**
```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d meurag.com
```

### 12.7. Seguran√ßa Important

#### 12.7.1. Senhas Fortes
```bash
# Gerar senha segura (Linux/Mac)
openssl rand -hex 32

# Resultado: uma senha como
# a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8
```

#### 12.7.2. Limita√ß√£o de Acesso
```python
# Exemplo: s√≥ aceitar IPs espec√≠ficos
IPS_PERMITIDOS = ["192.168.1.100", "203.0.113.45"]

@app.middleware("http")
async def verificar_ip(request, call_next):
    client_ip = request.client.host
    if client_ip not in IPS_PERMITIDOS:
        return Response("Acesso negado", status_code=403)
    return await call_next(request)
```

### 12.8. Resolu√ß√£o de Problemas da API

#### ‚ùå "Connection refused"
**Causa**: API n√£o est√° rodando
**Solu√ß√£o**: Execute `python run_system_api.py`

#### ‚ùå "401 Unauthorized"
**Causa**: Senha incorreta
**Solu√ß√£o**: Verifique se a API_KEY no `.env` est√° correta

#### ‚ùå "422 Unprocessable Entity"
**Causa**: Dados enviados est√£o incorretos
**Solu√ß√£o**: Verifique o formato JSON da pergunta

#### ‚ùå "503 Service Unavailable"
**Causa**: Sistema RAG n√£o inicializou
**Solu√ß√£o**: Verifique se todas as chaves de API est√£o corretas

#### ‚ùå API muito lenta
**Solu√ß√µes**:
- Use modelos menores: `OPENAI_ANSWER_GENERATION_MODEL=gpt-4o-mini`
- Aumente timeout do cliente para 60+ segundos
- Use m√∫ltiplos workers: `uvicorn api:app --workers 4`

### 12.9. Exemplos de Uso por Setor

#### 12.9.1. Restaurante
```python
# Integra√ß√£o com sistema de pedidos
def processar_duvida_cliente(duvida):
    resposta = api_rag.buscar(duvida)
    if "card√°pio" in resposta.lower():
        return resposta + "\n\n[BOT√ÉO: Ver Card√°pio Completo]"
    return resposta
```

#### 12.9.2. E-commerce
```python
# Chatbot para d√∫vidas de produtos
def chatbot_vendas(pergunta_cliente):
    resposta = api_rag.buscar(pergunta_cliente)
    
    # Detectar interesse em compra
    if any(palavra in pergunta_cliente.lower() 
           for palavra in ["comprar", "pre√ßo", "valor"]):
        resposta += "\n\nüõí Clique aqui para finalizar a compra!"
    
    return resposta
```

#### 12.9.3. Suporte T√©cnico
```python
# Sistema de tickets autom√°tico
def categorizar_ticket(problema):
    resposta = api_rag.buscar(f"Como resolver: {problema}")
    
    if "n√£o consegui encontrar" in resposta:
        return "ESCALAR", "Problema complexo - encaminhar para especialista"
    else:
        return "RESOLVIDO", resposta
```

### 12.10. M√©tricas e Analytics

#### 12.10.1. Contadores Simples
```python
# Adicionar ao seu c√≥digo
contador_perguntas = 0
contador_sucessos = 0

def fazer_pergunta(query):
    global contador_perguntas, contador_sucessos
    contador_perguntas += 1
    
    resposta = api_rag.buscar(query)
    
    if resposta and "n√£o consegui encontrar" not in resposta:
        contador_sucessos += 1
    
    print(f"Taxa de sucesso atual: {contador_sucessos/contador_perguntas:.1%}")
    return resposta
```

#### 12.10.2. Log Detalhado
```python
import json
from datetime import datetime

def log_interacao(pergunta, resposta, tempo_resposta):
    """Salva todas as intera√ß√µes para an√°lise"""
    registro = {
        "timestamp": datetime.now().isoformat(),
        "pergunta": pergunta,
        "resposta": resposta[:200] + "..." if len(resposta) > 200 else resposta,
        "tempo_resposta": tempo_resposta,
        "sucesso": "n√£o consegui encontrar" not in resposta.lower()
    }
    
    with open("interacoes.log", "a") as f:
        f.write(json.dumps(registro, ensure_ascii=False) + "\n")
```

---

## 13. Testes Automatizados - Verificando a Qualidade

### 13.1. O Que S√£o os Testes Automatizados

Os testes automatizados s√£o programas que verificam se o sistema est√° funcionando corretamente. √â como ter um assistente que testa todas as funcionalidades para voc√™ automaticamente.

**Por que s√£o importantes:**
- ‚úÖ Detectam problemas antes que voc√™ perceba
- ‚úÖ Garantem que tudo funciona ap√≥s mudan√ßas
- ‚úÖ Economizam tempo verificando o sistema
- ‚úÖ D√£o confian√ßa para usar o sistema

### 13.2. Pasta de Testes

O sistema possui uma pasta especial `tests/` com tudo relacionado a testes:

```
üìÅ tests/
‚îú‚îÄ‚îÄ üìÑ README.md              # Guia completo de como usar os testes
‚îú‚îÄ‚îÄ üìÑ TESTING_SUMMARY.md     # Resumo de todos os testes implementados
‚îú‚îÄ‚îÄ üöÄ run_tests.py          # Programa principal para executar testes
‚îú‚îÄ‚îÄ üåê test_api.py           # Testa a API (17 testes)
‚îú‚îÄ‚îÄ üì• test_ingestion.py     # Testa a ingest√£o de documentos
‚îú‚îÄ‚îÄ üîç test_search.py        # Testa o sistema de busca
‚îú‚îÄ‚îÄ üìä test_evaluator.py     # Testa o avaliador autom√°tico
‚îî‚îÄ‚îÄ üîÑ test_integration.py   # Testa o sistema completo
```

### 13.3. Como Usar os Testes (Passo a Passo)

#### Passo 1: Instalar Depend√™ncias dos Testes

```bash
pip install pytest pytest-asyncio
```

#### Passo 2: Verifica√ß√£o R√°pida (Smoke Test)

Este teste verifica se o b√°sico est√° funcionando:

```bash
python tests/run_tests.py --smoke
```

**O que ele faz:**
- ‚úÖ Verifica se a API est√° rodando
- ‚úÖ Confirma se as vari√°veis de ambiente est√£o configuradas
- ‚úÖ Testa uma busca simples

**Resultado esperado:**
```
üî• Executando Smoke Tests...
‚úÖ PASSOU - Health Check da API
‚úÖ PASSOU - Configura√ß√£o de Ambiente
‚úÖ PASSOU - Busca da API
üìä Smoke Tests: 3/3 passaram
```

#### Passo 3: Menu Interativo (Recomendado para Iniciantes)

```bash
python tests/run_tests.py
```

Voc√™ ver√° um menu assim:
```
üß™ SISTEMA RAG MULTIMODAL - EXECUTOR DE TESTES
============================================================
  1. Smoke Tests (verifica√ß√£o r√°pida)
  2. Testes B√°sicos (r√°pidos)
  3. Testes da API
  4. Testes de Ingest√£o
  5. Testes de Busca
  6. Testes do Avaliador
  7. Testes de Integra√ß√£o
  8. Todos os Testes
  9. Verificar Configura√ß√£o
  0. Sair

üéØ Escolha uma op√ß√£o:
```

**Para iniciantes, recomendamos:**
1. Come√ßar com "1" (Smoke Tests)
2. Depois tentar "3" (Testes da API)
3. Se tudo funcionar, testar "2" (Testes B√°sicos)

#### Passo 4: Testes Espec√≠ficos

**Testar apenas a API:**
```bash
python tests/run_tests.py --api
```

**Testar tudo rapidamente:**
```bash
python tests/run_tests.py --basic
```

**Verificar configura√ß√£o:**
```bash
python tests/run_tests.py --check
```

### 13.4. Entendendo os Resultados

#### Resultados Positivos ‚úÖ
```
tests/test_api.py::TestHealthAndBasics::test_health_check PASSED    [10%]
tests/test_api.py::TestAuthentication::test_valid_authentication PASSED [20%]
```

- **PASSED** = Teste passou (tudo certo!)
- **[10%]** = Progresso dos testes

#### Resultados com Problemas ‚ö†Ô∏è
```
tests/test_api.py::TestSearchEndpoint::test_search_basic SKIPPED    [30%]
```

- **SKIPPED** = Teste foi pulado (geralmente porque alguma API n√£o est√° configurada)

#### Resultados com Erro ‚ùå
```
tests/test_api.py::TestSearchEndpoint::test_search_basic FAILED     [30%]
```

- **FAILED** = Teste falhou (h√° um problema que precisa ser corrigido)

### 13.5. Tipos de Teste Dispon√≠veis

#### 13.5.1. Smoke Tests (Verifica√ß√£o R√°pida)
**Tempo:** ~30 segundos  
**O que faz:** Verifica se o b√°sico est√° funcionando  
**Quando usar:** Sempre que quiser verificar rapidamente se est√° tudo ok

#### 13.5.2. Testes da API
**Tempo:** ~2 minutos  
**O que faz:** Testa todos os endpoints da API (busca, avalia√ß√£o, ingest√£o)  
**Quando usar:** Ap√≥s configurar a API ou fazer mudan√ßas

#### 13.5.3. Testes de Ingest√£o
**Tempo:** ~5 minutos  
**O que faz:** Testa o processo de adicionar documentos  
**Quando usar:** Se tiver problemas para indexar documentos

#### 13.5.4. Testes de Busca
**Tempo:** ~3 minutos  
**O que faz:** Testa o sistema de perguntas e respostas  
**Quando usar:** Se as respostas n√£o estiverem boas

#### 13.5.5. Testes de Integra√ß√£o
**Tempo:** ~10 minutos  
**O que faz:** Testa o sistema completo do in√≠cio ao fim  
**Quando usar:** Para verifica√ß√£o completa antes de usar em produ√ß√£o

### 13.6. Resolvendo Problemas Comuns

#### Problema: "API n√£o est√° acess√≠vel"
**Solu√ß√£o:**
```bash
# Iniciar a API primeiro
python run_system_api.py
# Em outro terminal, executar os testes
python tests/run_tests.py --smoke
```

#### Problema: "APIs n√£o configuradas"
**Solu√ß√£o:**
1. Verificar arquivo `.env`
2. Confirmar se todas as chaves est√£o corretas
3. Executar verifica√ß√£o: `python tests/run_tests.py --check`

#### Problema: "Muitos testes falhando"
**Solu√ß√£o:**
1. Come√ßar com smoke test: `python tests/run_tests.py --smoke`
2. Se falhar, verificar configura√ß√£o b√°sica
3. Consultar `tests/README.md` para detalhes

#### Problema: "Testes muito lentos"
**Solu√ß√£o:**
```bash
# Executar apenas testes r√°pidos
python tests/run_tests.py --basic

# Parar no primeiro erro para economizar tempo
pytest tests/ -x
```

### 13.7. Quando Executar os Testes

#### üìÖ Rotina Di√°ria
- **Smoke Tests** toda vez que ligar o sistema
- **Testes da API** se for usar a API

#### üîß Ap√≥s Mudan√ßas
- **Testes B√°sicos** ap√≥s alterar configura√ß√µes
- **Testes Espec√≠ficos** ap√≥s mexer em componentes

#### üöÄ Antes de Produ√ß√£o
- **Todos os Testes** antes de usar com clientes reais
- **Testes de Integra√ß√£o** para valida√ß√£o completa

### 13.8. Documenta√ß√£o Adicional

Para informa√ß√µes mais detalhadas sobre os testes:

- **`tests/README.md`** - Guia t√©cnico completo
- **`tests/TESTING_SUMMARY.md`** - Resumo executivo dos testes
- **Manual da API** - Se√ß√£o 12 deste manual para testes da API

### 13.9. Exemplo Pr√°tico de Uso

**Cen√°rio:** Voc√™ configurou o sistema e quer verificar se est√° tudo funcionando.

**Passo a passo:**

1. **Verifica√ß√£o r√°pida:**
```bash
python tests/run_tests.py --smoke
```

2. **Se passou, testar a API:**
```bash
python tests/run_tests.py --api
```

3. **Se tudo passou, fazer um teste geral:**
```bash
python tests/run_tests.py --basic
```

4. **Se algo falhou, verificar configura√ß√£o:**
```bash
python tests/run_tests.py --check
```

**Resultado esperado:**
- Smoke Tests: 3/3 passaram
- Testes da API: 17/17 passaram
- Testes B√°sicos: maioria passa (alguns podem ser pulados se APIs opcionais n√£o est√£o configuradas)

### 13.10. Benef√≠cios dos Testes para Voc√™

#### üéØ Confian√ßa
- Sabe que o sistema est√° funcionando corretamente
- Pode fazer mudan√ßas sem medo de quebrar algo

#### ‚è∞ Economia de Tempo
- Detecta problemas automaticamente
- N√£o precisa testar manualmente toda vez

#### üõ°Ô∏è Seguran√ßa
- Previne problemas em produ√ß√£o
- Garante qualidade das respostas

#### üìà Aprendizado
- Os testes mostram como usar cada funcionalidade
- Servem como exemplos pr√°ticos

---

## üéì Conclus√£o Expandida

Agora voc√™ tem um sistema RAG completo com:

**Funcionalidades B√°sicas:**
- ‚úÖ Indexar qualquer documento
- ‚úÖ Fazer buscas inteligentes
- ‚úÖ Avaliar qualidade automaticamente
- ‚úÖ Personalizar para seu neg√≥cio

**Funcionalidades Avan√ßadas:**
- ‚úÖ **API RESTful profissional**
- ‚úÖ **Testes automatizados completos**
- ‚úÖ **Integra√ß√£o com qualquer sistema**
- ‚úÖ **Monitoramento autom√°tico**
- ‚úÖ **Dashboard em tempo real**
- ‚úÖ **Deploy em produ√ß√£o**

**Possibilidades de Integra√ß√£o:**
- ü§ñ Chatbots inteligentes
- üåê Sites e aplicativos
- üì± Apps mobile
- üíº Sistemas empresariais
- üìä Dashboards de an√°lise

**Pr√≥ximos Passos Sugeridos:**
1. **Comece simples** - Use o sistema b√°sico primeiro
2. **Teste a API** - Fa√ßa algumas chamadas manuais
3. **Integre gradualmente** - Conecte com um sistema por vez
4. **Monitore sempre** - Use as ferramentas de avalia√ß√£o
5. **Escale conforme necess√°rio** - Adicione recursos quando precisar

**Para Suporte:**
- üìñ Consulte este manual
- üß™ **Execute os testes**: `python tests/run_tests.py --smoke`
- üîç Use os comandos de diagn√≥stico
- üìä Monitore as m√©tricas regularmente
- üöÄ Comece pequeno e evolua gradualmente

**Pr√≥ximos Passos Recomendados:**
1. **Teste o sistema**: Execute `python tests/run_tests.py --smoke`
2. **Configure para produ√ß√£o**: Use a API para integrar com seus sistemas
3. **Monitore a qualidade**: Use o avaliador autom√°tico regularmente
4. **Expanda gradualmente**: Adicione mais documentos e funcionalidades

**Lembre-se**: Agora voc√™ tem uma ferramenta poderosa que pode crescer com seu neg√≥cio. A API permite integrar intelig√™ncia artificial em qualquer sistema existente, e os testes automatizados garantem que tudo funciona perfeitamente!

---

üî• **Sistema RAG Multimodal - Arquitetura Modular Completa**